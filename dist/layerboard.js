!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("vue"),require("vuex"),require("@cityofphiladelphia/phila-vue-comps"),require("leaflet"),require("@cityofphiladelphia/phila-vue-mapping"),require("axios"),require("@cityofphiladelphia/phila-vue-datafetch")):"function"==typeof define&&define.amd?define(["exports","vue","vuex","@cityofphiladelphia/phila-vue-comps","leaflet","@cityofphiladelphia/phila-vue-mapping","axios","@cityofphiladelphia/phila-vue-datafetch"],t):t(e.layerboard={},e.Vue,e.Vuex,e.philaVueComps,e.L,e.philaVueMapping,e.axios,e.philaVueDatafetch)}(this,function(exports,Vue,Vuex,philaVueComps,leaflet,philaVueMapping,axios,philaVueDatafetch){"use strict";function isMobileDevice(){var e=navigator.userAgent||navigator.vendor||window.opera||"";return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4))}function createStore(e){var t={isMobileOrTablet:isMobileDevice(),fullScreenMapEnabled:!1,bennyEndpoints:{},geocode:{status:null,data:null,input:null,related:null},layers:{layerUrls:{},inputLayerFilter:"",inputTagsFilter:""},map:{location:{lat:null,lng:null},center:e.map.center,zoom:e.map.zoom,scale:null,map:null,basemap:"pwd",imagery:"imagery2017",shouldShowImagery:!1,basemapLayers:{},webMap:null,webMapUrlLayer:null,webMapActiveLayers:[],webMapDisplayedLayers:[],webMapLayersAndRest:[],watchPositionOn:!1,intersectingFeatures:[],popupCoords:null,selectedPopupLayer:null,categories:[],selectedCategory:""},shouldShowAddressCandidateList:!1,candidates:[],addressEntered:null,cyclomedia:{initialized:!1,navBarOpen:!1,latLngFromMap:null,orientation:{yaw:null,hFov:null,xyz:null},active:!1,recordings:[]},pictometry:{ipa:null,active:!1,shapeIds:[],pngMarkerIds:[],zoom:null,map:{center:e.map.center,zoom:e.map.zoom}},lastSearchMethod:null,didToggleTopicsOn:!1,shouldShowTopics:!0,shouldShowMap:!0,windowWidth:0,route:null,modals:{help:{open:!1}}};return new Vuex.Store({state:t,getters:{},mutations:{setCyclomediaInitialized:function(e,t){e.cyclomedia.initialized=t},setIsMobileOrTablet:function(e,t){e.isMobileOrTablet=t},setFullScreenMapEnabled:function(e,t){e.fullScreenMapEnabled=t},setCategories:function(e,t){e.map.categories=t},setSelectedCategory:function(e,t){e.map.selectedCategory=t},setSelectedPopupLayer:function(e,t){e.map.selectedPopupLayer=t},setIntersectingFeatures:function(e,t){e.map.intersectingFeatures=t},setPopupCoords:function(e,t){e.map.popupCoords=t},setBennyEndpoints:function(e,t){e.bennyEndpoints=t},setBennyEndpoints2:function(e,t){e.bennyEndpoints2=t},setBennyEndpoints3:function(e,t){e.bennyEndpoints3=t},setLocation:function(e,t){e.map.location.lat=t.lat,e.map.location.lng=t.lng},setWatchPositionOn:function(e,t){e.map.watchPositionOn=t},setLayerUrls:function(e,t){e.layers.layerUrls=t},setInputLayerFilter:function(e,t){e.layers.inputLayerFilter=t},setInputTagsFilter:function(e,t){e.layers.inputTagsFilter=t},setMap:function(e,t){e.map.map=t.map},setWebMap:function(e,t){e.map.webMap=t},setWebMapUrlLayer:function(e,t){e.map.webMapUrlLayer=t},setWebMapActiveLayers:function(e,t){e.map.webMapActiveLayers=t},setWebMapDisplayedLayers:function(e,t){e.map.webMapDisplayedLayers=t},setWebMapLayersAndRest:function(e,t){e.map.webMapLayersAndRest=t},setWebMapLayersOpacity:function(e,t){e.map.webMapLayersAndRest.filter(function(e){return e.title===t.layerName})[0].opacity=t.opa},setLegend:function(e,t){e.map.webMapLayersAndRest.filter(function(e){return e.title===t.layerName})[0].legend=t.legend},setMapScale:function(e,t){e.map.scale=t},setBasemap:function(e,t){e.map.basemap=t},setImagery:function(e,t){e.map.imagery=t},setShouldShowImagery:function(e,t){e.map.shouldShowImagery=t},setMapCenter:function(e,t){e.map.center=t},setMapZoom:function(e,t){e.map.zoom=t},setGeocodeStatus:function(e,t){e.geocode.status=t},setGeocodeData:function(e,t){e.geocode.data=t},setGeocodeRelated:function(e,t){e.geocode.related=t},setGeocodeInput:function(e,t){e.geocode.input=t},setPictometryActive:function(t,i){e.pictometry.enabled&&(t.pictometry.active=i)},setPictometryIpa:function(e,t){e.pictometry.ipa=t},setPictometryShapeIds:function(e,t){e.pictometry.shapeIds=t},setPictometryPngMarkerIds:function(e,t){e.pictometry.pngMarkerIds=t},setPictometryMapCenter:function(e,t){e.pictometry.map.center=t},setPictometryMapZoom:function(e,t){e.pictometry.map.zoom=t},setPictometryZoom:function(e,t){e.pictometry.zoom=t},setCyclomediaActive:function(t,i){e.cyclomedia.enabled&&(t.cyclomedia.active=i)},setCyclomediaYaw:function(e,t){e.cyclomedia.orientation.yaw=t},setCyclomediaHFov:function(e,t){e.cyclomedia.orientation.hFov=t},setCyclomediaXyz:function(e,t){e.cyclomedia.orientation.xyz=t},setCyclomediaRecordings:function(e,t){e.cyclomedia.recordings=t},setCyclomediaLatLngFromMap:function(e,t){e.cyclomedia.latLngFromMap=t},setCyclomediaNavBarOpen:function(e,t){e.cyclomedia.navBarOpen=t},setDidToggleTopicsOn:function(e,t){e.didToggleTopicsOn=t},setShouldShowTopics:function(e,t){e.shouldShowTopics=t},setShouldShowMap:function(e,t){e.shouldShowMap=t},setWindowWidth:function(e,t){e.windowWidth=t},setRoute:function(e,t){e.route=t},setDidToggleModal:function(e,t){var i=t.name,a=t.open;console.log("setDidToggleModal, name:",i,"open:",a),e.modals[i].open=null===a?!e.modals[i].open:a},setShouldShowAddressCandidateList:function(e,t){e.shouldShowAddressCandidateList=t},setCandidates:function(e,t){e.candidates=t},setAddressEntered:function(e,t){e.addressEntered=t}}})}function configMixin(e,t){e.mixin({created:function(){this.$config=t}})}Vue=Vue&&Vue.hasOwnProperty("default")?Vue.default:Vue,Vuex=Vuex&&Vuex.hasOwnProperty("default")?Vuex.default:Vuex,axios=axios&&axios.hasOwnProperty("default")?axios.default:axios,philaVueDatafetch=philaVueDatafetch&&philaVueDatafetch.hasOwnProperty("default")?philaVueDatafetch.default:philaVueDatafetch,Vue.use(Vuex),function(){if("undefined"!=typeof document){var e=document.head||document.getElementsByTagName("head")[0],t=document.createElement("style"),i=" .forms-header[data-v-c37cf8b6] { padding: 5px; /*this keeps the box shadow over the scrollable part of the panel*/ position: relative; z-index: 1; -webkit-box-shadow: 0px 5px 7px -2px rgba(0,0,0,0.18); -moz-box-shadow: 0px 5px 7px -2px rgba(0,0,0,0.18); box-shadow: 0px 5px 7px -2px rgba(0,0,0,0.18); } .input-type[data-v-c37cf8b6] { margin-bottom: 0px; } .input-select[data-v-c37cf8b6] { margin-bottom: 0px; } .input-group[data-v-c37cf8b6] { height: 40px !important; margin-top: 6px; margin-bottom: 6px; } .input-group-label[data-v-c37cf8b6] { border-right: 1px; border-style: solid; padding-left: 8px; padding-right: 8px; padding-top: 0px; padding-bottom: 0px; height: 20px !important; } .topics-container[data-v-c37cf8b6] { padding: 20px; overflow-y: scroll; } .topics-container[data-v-c37cf8b6] { /* height: calc(100vh - 220px); */ height: calc(100vh - 268px); } /* @media screen and (max-width: 40em) { */ @media screen and (max-width: 750px) { .topics-container[data-v-c37cf8b6] { /* height: calc(100vh - 256px); */ height: calc(100vh - 300px); } } .om-search-control-container[data-v-c37cf8b6] { border-radius: 2px; box-shadow:0 2px 4px rgba(0,0,0,0.2),0 -1px 0px rgba(0,0,0,0.02); margin-top: 10px; margin-bottom: 10px; width: inherit; } .om-search-control-button[data-v-c37cf8b6] { width: 40px; background: #ccc; float: right; } .om-search-control-input[data-v-c37cf8b6] { font-family: 'Montserrat', 'Tahoma', sans-serif; font-size: 16px; } .om-search-control-input-tags[data-v-c37cf8b6] { font-family: 'Montserrat', 'Tahoma', sans-serif; font-size: 16px; } .input-font[data-v-c37cf8b6] { font-family: 'Montserrat', 'Tahoma', sans-serif; font-size: 16px; } ";t.type="text/css",t.styleSheet?t.styleSheet.cssText=i:t.appendChild(document.createTextNode(i)),e.appendChild(t)}}();var Checkbox=philaVueComps.Checkbox,TopicPanel={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{class:this.topicPanelContainerClass,attrs:{id:"topic-panel-container"}},[i("div",{staticClass:"cell"},[i("div",{staticClass:"forms-header"},[i("form",{staticClass:"om-search-control-input",on:{submit:function(t){return t.preventDefault(),e.handleLayerFilterFormX(t)},keydown:e.preventEnter}},[i("div",{staticClass:"input-group text-filter"},[i("span",{staticClass:"input-group-label input-font"},[e._v("Filter By Text:")]),e._v(" "),i("input",{staticClass:"input-type",attrs:{type:"text"},on:{keyup:e.handleLayerFilterFormKeyup}}),e._v(" "),""!=this.$store.state.layers.inputLayerFilter?i("div",{staticClass:"input-group-button"},[e._m(0)]):e._e()])]),e._v(" "),i("form",{staticClass:"om-search-control-input-tags",on:{submit:function(t){return t.preventDefault(),e.handleTagsFilterFormX(t)},keydown:e.preventEnter}},[i("div",{staticClass:"input-group text-filter"},[i("span",{staticClass:"input-group-label input-font"},[e._v("Filter By Tags:")]),e._v(" "),i("input",{staticClass:"input-type",attrs:{type:"text"},on:{keyup:e.handleTagsFilterFormKeyup}}),e._v(" "),""!=this.$store.state.layers.inputTagsFilter?i("div",{staticClass:"input-group-button"},[e._m(1)]):e._e()])]),e._v(" "),i("div",{staticClass:"input-group"},[i("span",{staticClass:"input-group-label input-font"},[e._v("Filter By Category:")]),e._v(" "),i("select",{staticClass:"input-select",on:{change:e.didSelectCategory}},e._l(this.categories,function(t){return i("option",{attrs:{value:"category"}},[e._v(" "+e._s(t)+" ")])}))])]),e._v(" "),i("div",{staticClass:"topics-container cell medium-cell-block-y",attrs:{id:"topics-container"}},[i("form",{attrs:{action:"#/"}},[i("fieldset",{staticClass:"options"},e._l(this.currentWmLayers,function(e,t){return i("checkbox",{key:e.id,attrs:{layer:e.layer,layerName:e.title,layerId:e.id,layerDefinition:e.rest.layerDefinition,opacity:e.opacity,legend:e.legend,tags:e.tags}})}))])])])])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("button",{staticClass:"om-search-control-button"},[t("i",{staticClass:"fa fa-times fa-lg"})])},function(){var e=this.$createElement,t=this._self._c||e;return t("button",{staticClass:"om-search-control-button"},[t("i",{staticClass:"fa fa-times fa-lg"})])}],_scopeId:"data-v-c37cf8b6",components:{Checkbox:Checkbox},computed:{windowWidth:function(){return this.$store.state.windowWidth},fullScreenMapEnabled:function(){return this.$store.state.fullScreenMapEnabled},topicPanelContainerClass:function(){return this.fullScreenMapEnabled?"cell medium-1 small-order-2 medium-order-1":this.windowWidth>=950?"cell medium-8 small-order-1 small-24 medium-order-2":"cell medium-10 small-order-1 small-24 medium-order-2"},categories:function(){return this.$store.state.map.categories},selectedCategory:function(){return this.$store.state.map.selectedCategory},scale:function(){return this.$store.state.map.scale},currentWmLayers:function(){for(var e=[],t=0,i=this.$store.state.map.webMapLayersAndRest;t<i.length;t+=1){var a=i[t];if(a.tags)(a.title.toLowerCase().includes(this.inputLayerFilter.toLowerCase())&&a.tags.join().toLowerCase().includes(this.inputTagsFilter.toLowerCase())&&a.category.includes(this.selectedCategory)||this.$store.state.map.webMapActiveLayers.includes(a.title))&&e.push(a);else{if(""!==this.inputTagsFilter)continue;(a.title.toLowerCase().includes(this.inputLayerFilter.toLowerCase())&&a.category.includes(this.selectedCategory)||this.$store.state.map.webMapActiveLayers.includes(a.title))&&e.push(a)}}return e},inputLayerFilter:function(){return this.$store.state.layers.inputLayerFilter},inputTagsFilter:function(){return this.$store.state.layers.inputTagsFilter},windowSize:function(){return this.$store.state.windowSize}},methods:{handleLayerFilterFormKeyup:function(e){var t=e.target.value;this.$store.commit("setInputLayerFilter",t)},handleLayerFilterFormX:function(e){e.target[0].value="",this.$store.commit("setInputLayerFilter","")},handleTagsFilterFormKeyup:function(e){var t=e.target.value;this.$store.commit("setInputTagsFilter",t)},handleTagsFilterFormX:function(e){e.target[0].value="",this.$store.commit("setInputTagsFilter","")},didSelectCategory:function(e){var t=e.target.selectedIndex;this.$store.commit("setSelectedCategory",this.categories[t])},preventEnter:function(e){13===e.keyCode&&e.preventDefault()}}},markersMixin={computed:{markers:function(){var e=[],t=this.geocodeGeom;if(t){var i={latlng:[].concat(t.coordinates).reverse(),key:this.geocodeResult.properties.street_address};e.push(i)}return e},locationMarker:function(){return{latlng:[this.$store.state.map.location.lat,this.$store.state.map.location.lng],radius:6,fillColor:"#ff3f3f",color:"#ff0000",weight:1,opacity:1,fillOpacity:1}}}};!function(){if("undefined"!=typeof document){var e=document.head||document.getElementsByTagName("head")[0],t=document.createElement("style"),i=" /* .map-panel-container { height: calc(100vh - 220px); } @media screen and (max-width: 40em) { .map-panel-container { height: calc(100vh - 256px); } } */ /*this allows the loading mask to fill the div*/ .mb-panel-map[data-v-11a08c18] { position: relative; } .mb-map-with-widget[data-v-11a08c18] { height: 50%; } /* @media (max-width: 1024px) { .mb-panel-map { height: 600px; } } */ .mb-search-control-container[data-v-11a08c18] { height: 48px; border-radius: 2px; box-shadow:0 2px 4px rgba(0,0,0,0.2),0 -1px 0px rgba(0,0,0,0.02); } .mb-search-control-button[data-v-11a08c18] { color: #fff; width: 50px; background: #2176d2; line-height: 48px; } .mb-search-control-input[data-v-11a08c18] { /* background-color: white; */ border: 0; /* height: 48px !important; */ /* line-height: 48px; */ padding: 15px; /* padding-left: 15px; */ /* padding-right: 15px; */ font-family: 'Montserrat', 'Tahoma', sans-serif; font-size: 16px; width: 275px; } /* .mb-map-with-widget { height: 50%; } */ .widget-slot[data-v-11a08c18] { display: inline-block; float: left; } .mb-map-loading-mask[data-v-11a08c18] { /*display: inline;*/ position: absolute; top: 0; height: 100%; width: 100%; background: rgba(0, 0 ,0 , 0.25); z-index: 1000; text-align: center; vertical-align: middle; } .mb-map-loading-mask-inner[data-v-11a08c18] { position: absolute; top: 40%; left: 40%; } @media screen and (max-width: 1023px) { .mb-search-control-input[data-v-11a08c18] { width: 250px; } } @media screen and (max-width: 900px) { .mb-search-control-input[data-v-11a08c18] { width: 200px; } } @media screen and (max-width: 800px) { .mb-search-control-input[data-v-11a08c18] { width: 150px; } } @media screen and (max-width: 750px) { .mb-search-control-input[data-v-11a08c18] { width: 250px; } } /* @media screen and (max-width: 639px) { .mb-search-control-input { width: 250px; } } */ @media screen and (max-width: 450px) { .mb-search-control-input[data-v-11a08c18] { width: 200px; } } @media screen and (max-width: 400px) { .mb-search-control-input[data-v-11a08c18] { width: 150px; } } @media screen and (max-width: 350px) { .mb-search-control-input[data-v-11a08c18] { width: 100px; } } ";t.type="text/css",t.styleSheet?t.styleSheet.cssText=i:t.appendChild(document.createTextNode(i)),e.appendChild(t)}}();var cyclomediaMixin=philaVueMapping.CyclomediaMixin,pictometryMixin=philaVueMapping.PictometryMixin,Map_=philaVueMapping.Map_,AddressInput=philaVueMapping.AddressInput,AddressCandidateList=philaVueMapping.AddressCandidateList,CircleMarker=philaVueMapping.CircleMarker,Control=philaVueMapping.Control,EsriTiledMapLayer=philaVueMapping.EsriTiledMapLayer,PngMarker=philaVueMapping.PngMarker,BasemapToggleControl=philaVueMapping.BasemapToggleControl,BasemapSelectControl=philaVueMapping.BasemapSelectControl,FullScreenMapToggleTab=philaVueMapping.FullScreenMapToggleTab,LocationControl=philaVueMapping.LocationControl,CyclomediaButton=philaVueMapping.CyclomediaButton,PictometryButton=philaVueMapping.PictometryButton,CyclomediaRecordingCircle=philaVueMapping.CyclomediaRecordingCircle,CyclomediaRecordingsClient=philaVueMapping.CyclomediaRecordingsClient,SvgViewConeMarker=philaVueMapping.SvgViewConeMarker,MeasureControl=philaVueMapping.MeasureControl,ControlCorner=philaVueMapping.ControlCorner,PopUp=philaVueMapping.PopUp,PopUpContent=philaVueMapping.PopUpContent,Polygon_=philaVueMapping.Polygon_,Polyline_=philaVueMapping.Polyline_,ModalAbout=philaVueMapping.ModalAbout,EsriWebMap=philaVueMapping.WebMap,EsriWebMapLayer=philaVueMapping.WebMapLayer,VectorMarker=philaVueMapping.VectorMarker,MapPanel={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{class:this.mapPanelContainerClass,attrs:{id:"map-panel-container"}},[e._m(0),e._v(" "),i("map_",{class:{"mb-map-with-widget":this.$store.state.cyclomedia.active||this.$store.state.pictometry.active},attrs:{id:"map-tag",center:this.mapCenter,zoom:this.$store.state.map.zoom,"zoom-control-position":"bottomright","min-zoom":this.$config.map.minZoom,"max-zoom":22},on:{"l-click":e.handleMapClick,"l-moveend":e.handleMapMove}},["Polygon"===this.selectedPopupLayerGeometryType||"MultiPolygon"===this.selectedPopupLayerGeometryType?i("polygon_",{attrs:{color:"#00ffff",fill:!1,weight:5,latlngs:this.selectedPopupLayerCoordinatesFlipped,pane:"highlightOverlay"}}):e._e(),e._v(" "),"LineString"===this.selectedPopupLayerGeometryType?i("polyline_",{attrs:{color:"#00ffff",weight:4,latlngs:this.selectedPopupLayerCoordinatesFlipped,pane:"highlightOverlay"}}):e._e(),e._v(" "),"Point"===this.selectedPopupLayerGeometryType?i("circle-marker",{attrs:{latlng:this.selectedPopupLayerCoordinatesFlipped,radius:7,fillColor:"#00ffff",color:"#00ffff",weight:this.locationMarker.weight,opacity:this.locationMarker.opacity,fillOpacity:this.locationMarker.fillOpacity,pane:"highlightOverlay"}}):e._e(),e._v(" "),i("esri-web-map",e._l(this.$store.state.map.webMapLayersAndRest,function(t,a){return e.shouldShowFeatureLayer(t)?i("esri-web-map-layer",{key:a,attrs:{layer:t.layer,layerName:t.title,layerDefinition:t.rest.layerDefinition,opacity:t.opacity,type:t.type2}}):e._e()})),e._v(" "),this.shouldShowPopup?i("pop-up",[i("pop-up-content")],1):e._e(),e._v(" "),e._l(this.$config.map.basemaps,function(t,a){return e.activeBasemap===a?i("esri-tiled-map-layer",{key:a,attrs:{name:a,url:t.url,"max-zoom":t.maxZoom,zIndex:t.zIndex,attribution:t.attribution}}):e._e()}),e._v(" "),e._l(this.$config.map.tiledLayers,function(t,a){return e.activeTiles.includes(a)?i("esri-tiled-map-layer",{key:a,attrs:{name:a,url:t.url,zIndex:t.zIndex,attribution:t.attribution}}):e._e()}),e._v(" "),e._l(e.markers,function(e,t){return i("vector-marker",{key:e.key,attrs:{latlng:e.latlng}})}),e._v(" "),this.cyclomediaActive?i("png-marker",{attrs:{icon:"../../src/assets/camera.png",latlng:e.cycloLatlng,rotationAngle:e.cycloRotationAngle}}):e._e(),e._v(" "),this.cyclomediaActive?i("svg-view-cone-marker",{attrs:{latlng:e.cycloLatlng,rotationAngle:e.cycloRotationAngle,hFov:e.cycloHFov}}):e._e(),e._v(" "),i("control-corner",{attrs:{vSide:"top",hSide:"almostright"}}),e._v(" "),i("control-corner",{attrs:{vSide:"top",hSide:"almostleft"}}),e._v(" "),e._m(2),e._v(" "),e._m(3),e._v(" "),e._m(5),e._v(" "),e._m(7),e._v(" "),e._m(8),e._v(" "),e._m(10),e._v(" "),e._m(11),e._v(" "),this.addressAutocompleteEnabled?i("AddressCandidateList",{attrs:{position:this.addressInputPosition}}):e._e(),e._v(" "),null!=this.$store.state.map.location.lat?i("circle-marker",{attrs:{latlng:this.locationMarker.latlng,radius:this.locationMarker.radius,fillColor:this.locationMarker.fillColor,color:this.locationMarker.color,weight:this.locationMarker.weight,opacity:this.locationMarker.opacity,fillOpacity:this.locationMarker.fillOpacity,pane:"highlightOverlay"}}):e._e(),e._v(" "),e._l(e.cyclomediaRecordings,function(t){return e.cyclomediaActive?i("cyclomedia-recording-circle",{key:t.imageId,attrs:{imageId:t.imageId,latlng:[t.lat,t.lng],size:1.2,color:"#3388ff",weight:1},on:{"l-click":e.handleCyclomediaRecordingClick}}):e._e()})],2),e._v(" "),i("modal-about"),e._v(" "),e._t("cycloWidget"),e._v(" "),e._t("pictWidget")],2)},staticRenderFns:[function(){var e=this.$createElement;return(this._self._c||e)("full-screen-map-toggle-tab")},function(){var e=this.$createElement;return(this._self._c||e)("basemap-toggle-control",{attrs:{position:"topright"}})},function(){var e=this.$createElement;return(this._self._c||e)("div",[this.shouldShowImageryToggle?this._m(1):this._e()],1)},function(){var e=this.$createElement,t=this._self._c||e;return t("div",[t("basemap-select-control",{attrs:{position:"topalmostright"}})],1)},function(){var e=this.$createElement;return(this._self._c||e)("pictometry-button",{attrs:{position:"topright",link:"pictometry",imgSrc:"../../src/assets/pictometry.png"}})},function(){var e=this.$createElement;return(this._self._c||e)("div",[this.shouldShowPictometryButton?this._m(4):this._e()],1)},function(){var e=this.$createElement;return(this._self._c||e)("cyclomedia-button",{attrs:{position:"topright",link:"cyclomedia",imgSrc:"../../src/assets/cyclomedia.png"},on:{click:this.handleCyclomediaButtonClick}})},function(){var e=this.$createElement;return(this._self._c||e)("div",[this.shouldShowCyclomediaButton?this._m(6):this._e()],1)},function(){var e=this.$createElement,t=this._self._c||e;return t("div",[t("measure-control",{attrs:{position:"bottomleft"}})],1)},function(){var e=this.$createElement;return(this._self._c||e)("location-control",{attrs:{position:"bottomright"},on:{click:this.handleButtonClick}})},function(){var e=this.$createElement;return(this._self._c||e)("div",[this.geolocationEnabled?this._m(9):this._e()],1)},function(){var e=this.$createElement,t=this._self._c||e;return t("div",[t("AddressInput",{attrs:{position:this.addressInputPosition}})],1)}],_scopeId:"data-v-11a08c18",mixins:[markersMixin,cyclomediaMixin,pictometryMixin],components:{AddressInput:AddressInput,AddressCandidateList:AddressCandidateList,Map_:Map_,Control:Control,EsriWebMap:EsriWebMap,EsriWebMapLayer:EsriWebMapLayer,EsriTiledMapLayer:EsriTiledMapLayer,CircleMarker:CircleMarker,VectorMarker:VectorMarker,PngMarker:PngMarker,BasemapToggleControl:BasemapToggleControl,BasemapSelectControl:BasemapSelectControl,FullScreenMapToggleTab:FullScreenMapToggleTab,LocationControl:LocationControl,PictometryButton:PictometryButton,CyclomediaButton:CyclomediaButton,CyclomediaRecordingCircle:CyclomediaRecordingCircle,SvgViewConeMarker:SvgViewConeMarker,MeasureControl:MeasureControl,ControlCorner:ControlCorner,PopUp:PopUp,PopUpContent:PopUpContent,Polygon_:Polygon_,Polyline_:Polyline_,ModalAbout:ModalAbout},mounted:function(){this.$controller.appDidLoad()},computed:{mapCenter:function(){return this.$store.state.map.center},addressAutocompleteEnabled:function(){return!0===this.$config.addressAutocomplete.enabled},addressInputPosition:function(){return this.isMobileOrTablet?"topleft":"topalmostleft"},isMobileOrTablet:function(){return this.$store.state.isMobileOrTablet},fullScreenMapEnabled:function(){return this.$store.state.fullScreenMapEnabled},windowWidth:function(){return this.$store.state.windowWidth},mapPanelContainerClass:function(){return this.fullScreenMapEnabled?"medium-24 small-order-1 small-24 medium-order-2 mb-panel mb-panel-map":this.windowWidth>=950?"medium-16 small-order-1 small-24 medium-order-2 mb-panel mb-panel-map":"medium-14 small-order-1 small-24 medium-order-2 mb-panel mb-panel-map"},cycloLatlng:function(){if(null!==this.$store.state.cyclomedia.orientation.xyz){var e=this.$store.state.cyclomedia.orientation.xyz;return[e[1],e[0]]}return this.$config.map.center},cycloRotationAngle:function(){return 57.29577951307855*this.$store.state.cyclomedia.orientation.yaw},cycloHFov:function(){return this.$store.state.cyclomedia.orientation.hFov},shouldShowCyclomediaButton:function(){return this.$config.cyclomedia.enabled&&!this.isMobileOrTablet},shouldShowPictometryButton:function(){return this.$config.pictometry.enabled&&!this.isMobileOrTablet},shouldShowPopup:function(){return this.intersectingFeatures.length>0},selectedPopupLayer:function(){return this.$store.state.map.selectedPopupLayer},selectedPopupLayerGeometryType:function(){return this.selectedPopupLayer?this.selectedPopupLayer.feature.geometry.type:null},selectedPopupLayerCoordinates:function(){return"Point"===this.selectedPopupLayerGeometryType||"LineString"===this.selectedPopupLayerGeometryType?this.selectedPopupLayer.feature.geometry.coordinates:"Polygon"===this.selectedPopupLayerGeometryType?this.selectedPopupLayer.feature.geometry.coordinates[0]:"MultiPolygon"===this.selectedPopupLayerGeometryType?this.selectedPopupLayer.feature.geometry.coordinates:void 0},selectedPopupLayerCoordinatesFlipped:function(){return"Point"===this.selectedPopupLayerGeometryType?this.flipCoords(this.selectedPopupLayerCoordinates):"MultiPolygon"!==this.selectedPopupLayerGeometryType?this.flipCoordsArray(this.selectedPopupLayerCoordinates):this.flipCoordsMultiPolygon(this.selectedPopupLayerCoordinates)},intersectingFeatures:function(){return this.$store.state.map.intersectingFeatures},geolocationEnabled:function(){return this.$config.geolocation.enabled},scale:function(){return this.$store.state.map.scale},webMapActiveLayers:function(){return this.$store.state.map.webMapActiveLayers},activeBasemap:function(){if(this.$store.state.map.shouldShowImagery)return this.$store.state.map.imagery;var e=this.$config.map.defaultBasemap;return this.$store.state.map.basemap||e},activeTiles:function(){return this.$config.map.basemaps[this.activeBasemap]?this.$config.map.basemaps[this.activeBasemap].tiledLayers:[]},basemaps:function(){return Object.values(this.$config.map.basemaps)},shouldShowImageryToggle:function(){return this.hasImageryBasemaps&&this.$config.map.imagery.enabled},imageryBasemaps:function(){return this.basemaps.filter(function(e){return"imagery"===e.type})},hasImageryBasemaps:function(){return this.imageryBasemaps.length>0},imageryYears:function(){return this.imageryBasemaps.map(function(e){return e.year})},historicBasemaps:function(){return this.basemaps.filter(function(e){return"historic"===e.type})},hasHistoricBasemaps:function(){return this.historicBasemaps.length>0},historicYears:function(){return this.historicBasemaps.map(function(e){return e.year})},geocodeResult:function(){return this.$store.state.geocode.data},geocodeGeom:function(){return(this.geocodeResult||{}).geometry},picOrCycloActive:function(){return!(!this.cyclomediaActive&&!this.pictometryActive)}},created:function(){var e=this.$config.defaultAddress;e&&this.$controller.goToDefaultAddress(e),(this.$config.cyclomedia||{}).enabled&&(this.$cyclomediaRecordingsClient=new CyclomediaRecordingsClient(this.$config.cyclomedia.recordingsUrl,this.$config.cyclomedia.username,this.$config.cyclomedia.password,4326))},watch:{picOrCycloActive:function(e){var t=this;this.$nextTick(function(){t.$store.state.map.map.invalidateSize()})}},methods:{flipCoords:function(e){return[e[1],e[0]]},flipCoordsArray:function(e){var t=[];for(var i in e)t[i]=[e[i][1],e[i][0]];return t},flipCoordsMultiPolygon:function(e){var t=[];for(var i in e){var a=[];for(var o in e[i][0])a[o]=[e[i][0][o][1],e[i][0][o][0]];t[i]=a}return t},shouldShowFeatureLayer:function(e){if(!e.rest.layerDefinition)return!!this.webMapActiveLayers.includes(e.title);if(e.rest.layerDefinition.minScale){if(this.scale<=e.rest.layerDefinition.minScale&&this.webMapActiveLayers.includes(e.title))return!0}else if(e.rest.layerDefinition.drawingInfo&&this.webMapActiveLayers.includes(e.title))return!0},handleMapClick:function(){document.getElementById("pvm-search-control-input").blur()},handleButtonClick:function(){document.getElementById("pvm-search-control-input").blur()},handleMapMove:function(e){var t=this.$store.state.map.map,i=this.$config.pictometry||{},a=t.getCenter(),o=a.lat,n=a.lng,r=[n,o],s=t.getZoom();this.$store.commit("setMapZoom",s);var c=this.$config.map.scales[s];if(this.$store.commit("setMapScale",c),i.enabled){this.$store.commit("setPictometryMapCenter",r);var l=t.getZoom();this.$store.commit("setPictometryMapZoom",l)}(this.$config.cyclomedia||{}).enabled&&(this.updateCyclomediaRecordings(),this.$store.commit("setCyclomediaLatLngFromMap",[o,n]))}}};!function(){if("undefined"!=typeof document){var e=document.head||document.getElementsByTagName("head")[0],t=document.createElement("style"),i=" /*don't highlight any form elements*/ input:focus, select:focus, textarea:focus, button:focus { outline: none; } /* standards applies padding to buttons, which causes some weirdness with buttons on the map panel. override here. */ button { padding: inherit; } .mb-root { position: absolute; bottom: 0; top: 78px; left: 0; right: 0; overflow: auto; } .datasets-button { display: none; margin: 0; } .mb-panel { height: 100%; } /*.mb-panel-topics-with-widget { height: 50%; }*/ /*small devices only*/ /* @media screen and (max-width: 39.9375em) { */ @media screen and (max-width: 750px) { .datasets-button { display: block; } } /* Medium and up */ /* @media screen and (min-width: 40em) { } */ /* Medium only */ /* @media screen and (min-width: 40em) and (max-width: 63.9375em) { } */ /* Large and up */ /* @media screen and (min-width: 64em) { } */ /* Large only */ /* @media screen and (min-width: 64em) and (max-width: 74.9375em) { } */ ";t.type="text/css",t.styleSheet?t.styleSheet.cssText=i:t.appendChild(document.createTextNode(i)),e.appendChild(t)}}();var CyclomediaWidget=philaVueMapping.CyclomediaWidget,PictometryWidget=philaVueMapping.PictometryWidget,Layer=philaVueMapping.PictometryLayer,ViewCone=philaVueMapping.PictometryViewCone,PngMarker$1=philaVueMapping.PictometryPngMarker,Layerboard={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"cell medium-auto grid-x",attrs:{id:"mb-root"}},[i("button",{staticClass:"small-24 button datasets-button",on:{click:e.toggleTopics}},[e._v(" "+e._s(this.buttonMessage)+" ")]),e._v(" "),i("topic-panel",{directives:[{name:"show",rawName:"v-show",value:e.shouldShowTopics,expression:"shouldShowTopics"}]}),e._v(" "),i("map-panel",{directives:[{name:"show",rawName:"v-show",value:e.shouldShowMap,expression:"shouldShowMap"}]},[this.shouldLoadCyclomediaWidget?i("cyclomedia-widget",{directives:[{name:"show",rawName:"v-show",value:e.cyclomediaActive,expression:"cyclomediaActive"}],attrs:{slot:"cycloWidget","screen-percent":"3"},slot:"cycloWidget"}):e._e(),e._v(" "),this.shouldLoadPictometryWidget?i("pictometry-widget",{directives:[{name:"show",rawName:"v-show",value:e.pictometryActive,expression:"pictometryActive"}],attrs:{slot:"pictWidget",apiKey:this.ak,secretKey:this.sk},slot:"pictWidget"},[this.pictometryShowAddressMarker?i("png-marker",{attrs:{latlng:[this.geocodeData.geometry.coordinates[1],this.geocodeData.geometry.coordinates[0]],icon:"markers.png",height:60,width:40,offsetX:0,offsetY:0}}):e._e(),e._v(" "),this.pictometryActive?i("layer"):e._e(),e._v(" "),this.cyclomediaActive&&this.pictometryActive?i("png-marker",{attrs:{latlng:e.cycloLatlng,icon:"camera2.png",height:20,width:30,offsetX:-2,offsetY:-2}}):e._e(),e._v(" "),this.cyclomediaActive&&this.pictometryActive?i("view-cone",{attrs:{latlng:e.cycloLatlng,rotationAngle:e.cycloRotationAngle,hFov:e.cycloHFov}}):e._e()],1):e._e()],1)],1)},staticRenderFns:[],components:{TopicPanel:TopicPanel,MapPanel:MapPanel,CyclomediaWidget:CyclomediaWidget,PictometryWidget:PictometryWidget,Layer:Layer,ViewCone:ViewCone,PngMarker:PngMarker$1},mounted:function(){window.addEventListener("resize",this.handleWindowResize),this.handleWindowResize();var e=this.$store;axios.get("https://api.knackhq.com/v1/objects/object_4/records/export?type=json",{params:{},headers:{"X-Knack-Application-Id":"550c60d00711ffe12e9efc64","X-Knack-REST-API-Key":"7bce4520-28dc-11e5-9f0a-4d758115b820"}}).then(function(t){for(var i={},a=0,o=t.data.records.filter(function(e){return"API"===e.field_12||"GeoService"===e.field_12});a<o.length;a+=1){var n=o[a],r=n.field_25.split('"')[1],s=void 0;s=r?r.split("query")[0].replace("https://","").replace("http://","").replace(/\/$/,"").toLowerCase():null,n.field_13_raw.length>0?i[s]=n.field_13_raw[0].id:i[s]=""}e.commit("setBennyEndpoints",i)},function(e){console.log("AXIOS ERROR Layerboard.vue")})},computed:{isMobileOrTablet:function(){return this.$store.state.isMobileOrTablet},shouldLoadCyclomediaWidget:function(){return this.$config.cyclomedia.enabled&&!this.isMobileOrTablet},shouldLoadPictometryWidget:function(){return this.$config.pictometry.enabled&&!this.isMobileOrTablet},fullScreenMapEnabled:function(){return this.$store.state.fullScreenMapEnabled},cyclomediaActive:function(){return this.$store.state.cyclomedia.active},cycloLatlng:function(){if(null!==this.$store.state.cyclomedia.orientation.xyz){var e=this.$store.state.cyclomedia.orientation.xyz;return[e[1],e[0]]}return this.$config.map.center},cycloRotationAngle:function(){return 57.29577951307855*this.$store.state.cyclomedia.orientation.yaw},cycloHFov:function(){return this.$store.state.cyclomedia.orientation.hFov},pictometryActive:function(){return this.$store.state.pictometry.active},pictometryZoom:function(){return this.$store.state.pictometry.zoom},pictometryShowAddressMarker:function(){return!(!this.pictometryActive||!this.geocodeData)&&!(this.pictometryZoom<20&&this.cyclomediaActive)},geocodeData:function(){return this.$store.state.geocode.data},ak:function(){var e=window.location.hostname;return"atlas.phila.gov"===e?this.$config.pictometry.apiKey:"atlas-dev.phila.gov"===e?this.$config.pictometryDev.apiKey:"cityatlas.phila.gov"===e?this.$config.pictometryCity.apiKey:"cityatlas-dev.phila.gov"===e?this.$config.pictometryCityDev.apiKey:"10.8.101.67"===e?this.$config.pictometryLocal.apiKey:void 0},sk:function(){var e=window.location.hostname;return"atlas.phila.gov"===e?this.$config.pictometry.secretKey:"atlas-dev.phila.gov"===e?this.$config.pictometryDev.secretKey:"cityatlas.phila.gov"===e?this.$config.pictometryCity.secretKey:"cityatlas-dev.phila.gov"===e?this.$config.pictometryCityDev.secretKey:"10.8.101.67"===e?this.$config.pictometryLocal.secretKey:void 0},geocodeData:function(){return this.$store.state.geocode.data},windowWidth:function(){return this.$store.state.windowWidth},windowHeight:function(){return this.$store.state.windowSize.height},didToggleTopicsOn:function(){return this.$store.state.didToggleTopicsOn},buttonMessage:function(){return this.didToggleTopicsOn?"See Map":"See Datasets"},shouldShowTopics:function(){return this.$store.state.shouldShowTopics},shouldShowMap:function(){return this.$store.state.shouldShowMap}},watch:{pictometryShowAddressMarker:function(e){},windowWidth:function(e){this.calculateShouldShowTopics(),this.calculateShouldShowMap()},fullScreenMapEnabled:function(e){this.calculateShouldShowTopics(),this.calculateShouldShowMap()},didToggleTopicsOn:function(e){this.calculateShouldShowTopics(),this.calculateShouldShowMap()},shouldShowTopics:function(e){this.handleWindowResize()},shouldShowMap:function(e){this.handleWindowResize()}},methods:{toggleTopics:function(){var e=this.$store.state.didToggleTopicsOn;this.$store.commit("setDidToggleTopicsOn",!e)},calculateShouldShowTopics:function(){var e=this.windowWidth<750,t=this.$store.state.didToggleTopicsOn,i=this.$store.state.fullScreenMapEnabled,a=!e&&!i||e&&t;this.$store.commit("setShouldShowTopics",a)},calculateShouldShowMap:function(){var e=this.windowWidth>750,t=this.$store.state.didToggleTopicsOn,i=e||!t;this.$store.commit("setShouldShowMap",i)},handleWindowResize:function(){var e=document.getElementById("mb-root"),t=window.getComputedStyle(e).getPropertyValue("width"),i=parseInt(t.replace("px",""));this.$store.commit("setWindowWidth",i)}}};function isObject(e){return e&&"object"==typeof e&&!Array.isArray(e)&&null!==e}function mergeDeep(e,t){var i=Object.assign({},e);return isObject(e)&&isObject(t)&&Object.keys(t).forEach(function(a){var o,n;isObject(t[a])?a in e?i[a]=mergeDeep(e[a],t[a]):Object.assign(i,((o={})[a]=t[a],o)):Object.assign(i,((n={})[a]=t[a],n))}),i}var controllerMixin=philaVueDatafetch;function initOpenMaps(clientConfig){var baseConfigUrl=clientConfig.baseConfig;return axios.get(baseConfigUrl).then(function(response){var data=response.data,baseConfigFn=eval(data),gatekeeperKey=clientConfig.gatekeeperKey,baseConfig=baseConfigFn({gatekeeperKey:gatekeeperKey}),config=mergeDeep(baseConfig,clientConfig);Vue.use(configMixin,config);var store=createStore(config);Vue.use(controllerMixin,{config:config,store:store});var vm=new Vue({el:config.el||"#layerboard",render:function(e){return e(Layerboard)},store:store})},function(e){console.error("AXIOS ERROR loading base config")})}exports.default=initOpenMaps,exports.Layerboard=Layerboard,Object.defineProperty(exports,"__esModule",{value:!0})});
//# sourceMappingURL=layerboard.js.map
